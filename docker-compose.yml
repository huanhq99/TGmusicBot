version: '3.8'

services:
  tgmusicbot:
    # 使用 Docker Hub 镜像（推荐）
    image: huanhq99/tgmusicbot:latest
    # 或者本地构建
    # build: .
    
    container_name: tgmusicbot
    restart: unless-stopped
    
    ports:
      - "8080:8080"  # Web 管理界面
    
    volumes:
      # 数据持久化
      - ./data:/app/data              # 数据库、缓存、日志
      - ./uploads:/app/uploads        # 下载的音乐文件
      # 如果需要 MusicTag 集成，映射 MusicTag 监控目录
      # - /path/to/musictag/watch:/musictag
    
    env_file:
      - .env
    
    environment:
      - TZ=Asia/Shanghai
      - DATA_DIR=/app/data
      - UPLOAD_DIR=/tmp/tgmusicbot_uploads
      - MUSIC_TARGET_DIR=/app/uploads
    
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"
